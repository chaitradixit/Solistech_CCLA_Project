-- Update DIOADDCAP to DIOCAPREPAY instead
UPDATE REF_INSTRUCTION_TYPE SET INSTRUCTION_TYPE_NAME = 'DIOCAPREPAY' WHERE INSTRUCTION_TYPE_NAME = 'DIOADDCAP';

UPDATE DOCUMENT_CLASSES SET DOC_CLASS = 'DIOCAPREPAY' WHERE DOC_CLASS = 'DIOADDCAP';
UPDATE DUAL_INDEX_RULES SET DOCUMENT_CLASS = 'DIOCAPREPAY' WHERE DOCUMENT_CLASS = 'DIOADDCAP';

-- Add new DIODEPBNK
REM INSERTING into REF_INSTRUCTION_TYPE
Insert into REF_INSTRUCTION_TYPE (INSTRUCTION_TYPE_ID,INSTRUCTION_TYPE_NAME,TRANSACTION_TYPE_ID,INSTRUCTION_DESCRIPTION,IS_FINANCIAL_TRANSACTION,SUBMIT_TO_SPP,REQUIRE_SIGNATURES,IS_SUPPORTING,DATE_ADDED,LAST_UPDATED,SETTLEMENT_OFFSET) values (122,'DIODEPBNK',1,'Dio Loan repayment. Includes capital and interest repayments, but not additional capital repayments',1,1,0,0,to_timestamp('24-AUG-11 13.58.00.444000000','DD-MON-RR HH24.MI.SS.FF'),to_timestamp('24-AUG-11 13.58.03.573000000','DD-MON-RR HH24.MI.SS.FF'),0);

REM INSERTING into DOCUMENT_CLASSES
Insert into DOCUMENT_CLASSES (SCHPRIMARYKEY,SCHCREATETIMESTAMP,SCHMODIFYTIMESTAMP,SCHSOURCEID,DOC_CLASS,SUBMIT_TO_SPP,DESCRIPTION,IS_SUPPORTING,IS_MULTIDOC,REQUIRE_ACCOUNT_DATA,IS_TRANSACTION,IS_STANDING_ORDER,SIGNATURES_REQUIRED,IS_MANDATE) values ('127',to_timestamp('24-AUG-11 14.50.39.925000000','DD-MON-RR HH24.MI.SS.FF'),to_timestamp('24-AUG-11 14.50.42.589000000','DD-MON-RR HH24.MI.SS.FF'),'cclaucmdev','DIODEPBNK','Y','Dio Loan repayment. Includes capital and interest repayments, but not additional capital repayments','N',null,'Y','Y','N',null,'N');

-- Dual Index rules
INSERT INTO DUAL_INDEX_RULES VALUES (SEQ_DUAL_INDEX_RULE.NEXTVAL, 'DIODEPBNK', 1);

INSERT INTO DUAL_INDEX_RULE_FIELDS
SELECT DUAL_INDEX_RULE_ID, 9, SYSDATE FROM DUAL_INDEX_RULES
WHERE DOCUMENT_CLASS IN ('DIODEPBNK');

INSERT INTO DUAL_INDEX_RULE_FIELDS
SELECT DUAL_INDEX_RULE_ID, 2, SYSDATE FROM DUAL_INDEX_RULES
WHERE DOCUMENT_CLASS IN ('DIODEPBNK');

INSERT INTO DUAL_INDEX_RULE_FIELDS
SELECT DUAL_INDEX_RULE_ID, 18, SYSDATE FROM DUAL_INDEX_RULES
WHERE DOCUMENT_CLASS IN ('DIODEPBNK');

INSERT INTO DUAL_INDEX_RULE_FIELDS
SELECT DUAL_INDEX_RULE_ID, 3, SYSDATE FROM DUAL_INDEX_RULES
WHERE DOCUMENT_CLASS IN ('DIODEPBNK');

-- Add data fields for DIODEPBNK
INSERT INTO APPLICABLE_INSTRUCTION_DATA
SELECT SEQ_APPLICABLE_INSTR_DATA.NEXTVAL, INSTRUCTION_DATA_ID, 122, IS_OPTIONAL  FROM APPLICABLE_INSTRUCTION_DATA aid
WHERE aid.INSTRUCTION_TYPE_ID = 14;

-- Update form type name
UPDATE REF_FORM_TYPE SET FORM_TYPE_NAME = 'Dio Loan Additional Capital Repayment' WHERE FORM_TYPE_ID = 14;
-- Update Instruction Type description
UPDATE REF_INSTRUCTION_TYPE SET INSTRUCTION_DESCRIPTION = 'Diocesan Loan Additional Capital Repayment' WHERE INSTRUCTION_TYPE_ID = 120;

-- Change gen doc type for draw-down form to DIOWTHBACS
UPDATE REF_FORM_TYPE SET GEN_INSTRUCTION_TYPE_ID = 119, RET_INSTRUCTION_TYPE_ID = 119 WHERE FORM_TYPE_ID = 13;

-- New Verification Source (Dio Loan Resolution)
REM INSERTING into REF_VERIFICATION_SOURCE
Insert into REF_VERIFICATION_SOURCE 
(VERIFICATION_SOURCE_ID,VER_SOURCE_NAME,VER_SOURCE_DESCRIPTION,SUPPORTING_DOC_REQUIRED,IS_OVERRIDE) 
values (19,'Dio Loan Resolution','Resolution authorising undertaking of Diocesan Loan transaction',1,0);

-- New Org Attrib for above verification source
REM INSERTING into REF_ELEMENT_ATTRIBUTES
Insert into REF_ELEMENT_ATTRIBUTES (ELEMENT_ATTRIBUTE_ID,ELEMENT_ATTRIBUTE_NAME,ELEMENT_TYPE_ID,ELEMENT_ATTRIBUTE_DESCRIPTION,SET_BY_USER,VERIFICATION_SOURCE_ID,ELEMENT_IDENTIFIER_ID,USER_GROUPS,ELEMENT_ATTRIBUTE_DATA_TYPE,ELEMENT_ATTRIBUTE_TYPE_ID) values (48,'Dio Loan Resolution received',1,'Resolution letter for undertaking of Dio Loan transactions',1,19,null,null,'BOOL',1);

-- Add new Email Indemnity Form Type
REM INSERTING into REF_FORM_TYPE
Insert into REF_FORM_TYPE (FORM_TYPE_ID,FORM_TYPE_NAME,GEN_INSTRUCTION_TYPE_ID,RET_INSTRUCTION_TYPE_ID,FORM_HANDLER_CLASS,FORM_TYPE_SHORTNAME,IS_SINGLETON,ELEMENT_TYPE_ID) values (15,'Email Indemnity',57,57,'com.ecs.stellent.ccla.clientservices.form.EmailIndemnityFormHandler','EMAIL-INDEM',1,1);

